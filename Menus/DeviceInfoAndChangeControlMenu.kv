#:kivy 1.11.1

#:import DeviceInfoAndChangeControlMenu DeviceInfoAndChangeControlMenu

#This KV file defines the various Device Information and Change Control screens and widgets it is linked to the DeviceInfoAndChangeControlMenu.py for defining the type of widget and the functions that are called


<DeviceInfoMenu@Screen>:
    on_pre_enter: app.current_screen = "Device Information and Change Control"
    on_pre_enter: app.previous_screen.append('DeviceInfoMenuScreen')
    name: 'DeviceInfoMenuScreen'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        MenuBar:
            id: _Menu_Bar
            main_menu_root: root
            size_hint: 1, None
            height: 50
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        DeviceInfoMenuButtons:
            id: _Device_Info_Menu_Buttons_
            main_menu_root: root
            size_hint: 0.9, None
            padding: 50
            height: root.height - _Menu_Bar.height



<DeviceInfoMenuButtons>:
    orientation: 'vertical'
    padding: 5
    spacing: 2
    Button:
        text: 'Poll And Extract Device Information'
        on_release: root.DeviceInfoPollAndExtractButton(*args)
    Button:
        text: 'Change Control'
        on_release: root.DeviceInfoChangeControlButton(*args)


        
		
		
<DeviceInfoPollAndExtract>:
    on_pre_enter: app.current_screen = "Device Information and Change Control - Poll and Extract"
    on_pre_enter: app.previous_screen.append('DeviceInfoPollAndExtractScreen')
    name: 'DeviceInfoPollAndExtractScreen'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        MenuBar:
            id: _Menu_Bar
            main_menu_root: root
            size_hint: 1, None
            height: 50
    FloatLayout:
        #anchor_x: 'left'
        #anchor_y: 'center'
        DeviceInfoPollAndExtractInfoSelect:
            id: _Device_Info_Poll_And_Extract_Info_Select_
            pos_hint:{'center_x':0.15, 'y':0.25}
            size_hint: 0.2, 0.5
    FloatLayout:
        #anchor_x: 'center'
        #anchor_y: 'center'
        DeviceInfoPollAndExtractLayout:
            id: _Device_Info_Poll_And_Extract_Layout_
            pos_hint:{'center_x':0.6, 'y':0.7}
            main_menu_root: root
            size_hint: 0.7, None
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        padding: 5
        Button:
            id: _Device_Credentials_Button_
            text: 'Set Device \nCredentials'
            size_hint: 0.16, 0.08
            on_release: root.OpenCredentialPopup()
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 15
        IPv4TargetDeviceLayout
            id: _IPv4_Target_Device_Layout_
            size_hint: 0.9, None
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 5
        Execute:
            id: _Execute_Button_
            on_release: root.DeviceInfoPollAndExtractExecute() 



        
<DeviceInfoPollAndExtractLayout@GridLayout>:
    orientation: 'vertical'
    rows: 3
    padding: 5
    spacing: 40
    Label: 
        id: PolledDeviceInfoLabel
        markup: True
        text: 'Device Information'
        size_hint_y: None
        height: '32dp'
    TextInput:
        id: PolledDeviceInfoOutput
        readonly: True
        size_hint_y: None
        height: '165dp'
        line_spacing: 13
        text: 'Hostname: \nDevice Type: \nIOS Version: \nDomain: \nUptime: '
    DeviceInfoPollAndExtractStoreLocalLayout:
        id: DeviceInfoPollAndExtractStoreLocalLayout



<DeviceInfoPollAndExtractStoreLocalLayout@GridLayout>:
    orientation: 'vertical'
    rows: 1
    padding: 5
    spacing: 5
    Label: 
        text: 'Store Results Locally'
        size_hint_y: None
        height: StoreLocalCheckbox.height
    CheckBox:
        id: StoreLocalCheckbox
        size_hint_y: None
        height: '32dp'
        on_active: root.parent.parent.parent.DeviceInfoPollAndExtractStoreLocalSelect()
    Label:
        id: FileNameLabel
        text: 'Desired File Name'
        size_hint_y: None
        height: FileNameTextInput.height
        opacity: 0
        disabled: True
    TextInput:
        id: FileNameTextInput
        hint_text:'File Name'
        multiline: False
        size_hint_y: None
        height: '32dp'
        opacity: 0
        disabled: True
    




<DeviceInfoPollAndExtractInfoSelect@GridLayout>:
	orientation: 'vertical'
    cols: 2	
    padding: 5
    spacing: 1
    Label: 
        text: 'Hostname'
        size_hint_y: None
        height: HostnameInfoCheckbox.height
    CheckBox:
        id: HostnameInfoCheckbox
        size_hint_y: None
        height: '32dp'
    Label: 
        text: 'Device Type'
        size_hint_y: None
        height: DeviceTypeInfoCheckbox.height
    CheckBox:
        id: DeviceTypeInfoCheckbox
        size_hint_y: None
        height: '32dp'
    Label: 
        text: 'IOS Version'
        size_hint_y: None
        height: IOSVersionInfoCheckbox.height
    CheckBox:
        id: IOSVersionInfoCheckbox
        size_hint_y: None
        height: '32dp'
    Label: 
        text: 'Domain'
        size_hint_y: None
        height: DomainInfoCheckbox.height
    CheckBox:
        id: DomainInfoCheckbox
        size_hint_y: None
        height: '32dp'
    Label: 
        text: 'Uptime'
        size_hint_y: None
        height: UptimeInfoCheckbox.height
    CheckBox:
        id: UptimeInfoCheckbox
        size_hint_y: None
        height: '32dp'



















<DeviceInfoChangeControlMenu@Screen>:
    on_pre_enter: app.current_screen = "Device Information and Change Control - Change Control"
    on_pre_enter: app.previous_screen.append('DeviceInfoChangeControlScreen')
    name: 'DeviceInfoChangeControlScreen'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        MenuBar:
            id: _Menu_Bar
            main_menu_root: root
            size_hint: 1, None
            height: 50
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        DeviceInfoChangeControlMenuButtons:
            id: _Device_Info_Change_Control_Menu_Buttons_
            main_menu_root: root
            size_hint: 0.9, None
            padding: 50
            height: root.height - _Menu_Bar.height



<DeviceInfoChangeControlMenuButtons>:
    orientation: 'vertical'
    padding: 5
    spacing: 2
    Button:
        text: 'Save Configuration From Device'
        on_release: root.DeviceInfoChangeControlSaveConfButton(*args)
    Button:
        text: 'Upload Configuration To Device'
        on_release: root.DeviceInfoChangeControlUploadConfButton(*args)
    Button:
        text: 'Compare Configurations'
        on_release: root.DeviceInfoChangeControlCompareConfButton(*args)
		





<DeviceInfoChangeControlSaveConf>:
    on_pre_enter: app.current_screen = "Change Control - Save Configuration"
    on_pre_enter: app.previous_screen.append('DeviceInfoChangeControlSaveConfScreen')
    name: 'DeviceInfoChangeControlSaveConfScreen'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        MenuBar:
            id: _Menu_Bar
            main_menu_root: root
            size_hint: 1, None
            height: 50
    FloatLayout:
        #anchor_x: 'center'
        #anchor_y: 'center'
        DeviceInfoChangeControlSaveConfLayout:
            id: _Device_Info_Change_Control_Save_Conf_Layout_
            pos_hint:{'center_x':0.5, 'y':0.5}
            main_menu_root: root
            size_hint: 0.9, None
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        padding: 5
        Button:
            id: _Device_Credentials_Button_
            text: 'Set Device \nCredentials'
            size_hint: 0.16, 0.08
            on_release: root.OpenCredentialPopup()
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 15
        IPv4TargetDeviceLayout
            id: _IPv4_Target_Device_Layout_
            size_hint: 0.9, None
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 5
        Execute:
            id: _Execute_Button_
            on_release: root.DeviceInfoChangeControlSaveConfExecute()
            
    
<DeviceInfoChangeControlSaveConfLayout@GridLayout>:
    orientation: 'vertical'
    rows: 2
    spacing: 2
    GridLayout:
        orientation: 'vertical'
        rows: 1
        Label:
            text: ''
        Label:
            text: 'Runinng Configuration'
        Label:
            text: 'Start-Up Configuration'
    GridLayout:
        orientation: 'vertical'
        rows: 1
        Label: 
            text: 'Select Configuration Type to Save'
            size_hint_y: None
            height: RunningTrue.height
            text_size: self.width, None
        CheckBox:
            id: RunningTrue
            size_hint_y: None
            height: '32dp'
            group: 'SaveConfSelect'
            active: True
        CheckBox:
            id: StartupTrue
            size_hint_y: None
            height: '32dp'
            group: 'SaveConfSelect'  




<DeviceInfoChangeControlUploadConf>:
    on_pre_enter: app.current_screen = "Change Control - Upload Configuration"
    on_pre_enter: app.previous_screen.append('DeviceInfoChangeControlUploadConfScreen')
    name: 'DeviceInfoChangeControlUploadConfScreen'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        MenuBar:
            id: _Menu_Bar
            main_menu_root: root
            size_hint: 1, None
            height: 50
    FloatLayout:
        Label:
            id: _Device_Info_Change_Control_Upload_Conf_Label_
            pos_hint:{'center_x':0.5, 'y':0.35}
            text: "Select the configuration file to upload"
            height: '32dp'
    FloatLayout:
        DeviceInfoChangeControlUploadConfLayout:
            id: _Device_Info_Change_Control_Upload_Conf_Layout_
            pos_hint:{'center_x':0.5, 'y':0.17}
            main_menu_root: root
            padding: 25
            size_hint: 0.9, 0.7
            height: root.height - _Menu_Bar.height - _IPv4_Target_Device_Layout_.height - _Execute_Button_.height - _Device_Info_Change_Control_Upload_Conf_Label_.height
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        padding: 5
        Button:
            id: _Device_Credentials_Button_
            text: 'Set Device \nCredentials'
            size_hint: 0.16, 0.08
            on_release: root.OpenCredentialPopup()
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 15
        IPv4TargetDeviceLayout
            id: _IPv4_Target_Device_Layout_
            size_hint: 0.9, None
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 5
        Execute:
            id: _Execute_Button_
            on_release: root.DeviceInfoChangeControlUploadConfExecute()
            

		
<DeviceInfoChangeControlUploadConfLayout@BoxLayout>
    orientation: 'vertical'
    BoxLayout:
        size_hint_y: None
        height: '48dp'

        ToggleButton:
            text: 'Icon View'
            state: 'down'
            group: 'filechooser'
            on_release: FileChooser.view_mode = 'icon'

        ToggleButton:
            text: 'List View'
            group: 'filechooser'
            on_release: FileChooser.view_mode = 'list'
    FileChooser:
        id: FileChooser
        path: app.selected_storage_directory + '/Outputs/SaveConfOutput/'

        FileChooserIconLayout
        FileChooserListLayout
    

<DeviceInfoChangeControlUploadConfUploadType@GridLayout>: #To be used if NAPALM can be fixed
    orientation: 'vertical'
    rows: 2
    spacing: 2
    GridLayout:
        orientation: 'vertical'
        rows: 1
        Label:
            text: ''
        Label:
            text: 'Replace Configuration'
        Label:
            text: 'Merge Configuration'
    GridLayout:
        orientation: 'vertical'
        rows: 1
        Label: 
            text: 'Select Configuration Upload Method'
            size_hint_y: None
            height: ReplaceTrue.height
            text_size: self.width, None
        CheckBox:
            id: ReplaceTrue
            size_hint_y: None
            height: '32dp'
            group: 'UploadConfType'
            active: True
        CheckBox:
            id: MergeTrue
            size_hint_y: None
            height: '32dp'
            group: 'UploadConfType'  




<DeviceInfoChangeControlCompareConf>:
    on_pre_enter: app.current_screen = "Change Control - Compare Configurations"
    on_pre_enter: app.previous_screen.append('DeviceInfoChangeControlCompareConfScreen')
    name: 'DeviceInfoChangeControlCompareConfScreen'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        MenuBar:
            id: _Menu_Bar
            main_menu_root: root
            size_hint: 1, None
            height: 50
    FloatLayout:
        #anchor_x: 'center'
        #anchor_y: 'center'
        DeviceInfoChangeControlCompareConfFileSelect
            id: _Device_Info_Change_Control_Compare_Conf_File_Select_      
            pos_hint:{'center_x':0.5, 'y':0.70}
            main_menu_root: root
            size_hint: 0.9, None
    FloatLayout:
        padding: 5
        DeviceInfoChangeControlCompareConfOpenHTML:
            id: _Device_Info_Change_Control_Compare_Conf_Open_HTML_
            pos_hint:{'center_x':0.5, 'y':0.3}
            size_hint: 0.4, 0.3
               
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        padding: 5
        Execute:
            id: _Execute_Button_
            on_release: root.DeviceInfoChangeControlCompareConfExecute()
            


<DeviceInfoChangeControlCompareConfFileSelect@GridLayout>:
    orientation: 'vertical' 
    cols: 2
    spacing: 10
    Button:
        text: 'Set File 1'
        on_release: root.parent.parent.OpenFile1Popup()
        size_hint_y: None
        height: '32dp'
    Button:
        text: 'Set File 2'
        on_release: root.parent.parent.OpenFile2Popup()
        size_hint_y: None
        height: '32dp'
    Label: 
        id: CompareConfFile1Label
        markup: True
        text: 'File 1: '
        size_hint_y: None
        height: '32dp'
        text_size: self.width, None
        halign: 'left'
    Label: 
        id: CompareConfFile2Label
        markup: True
        text: 'File 2: '
        size_hint_y: None
        height: '32dp'
        text_size: self.width, None
        halign: 'left'
        


<DeviceInfoChangeControlCompareConfOpenHTML@GridLayout>:
    orientation: 'vertical' 
    rows: 2
    spacing: 5
    Label:   
        id: CurrentHTMLSelection
        markup: True
        text: "No Comparison Has Been Executed"
        text_size: self.width, None
        height: self.texture_size[1]
    Button:
        id: CurrentHTMLButton
	    text: 'Open Configuration File Comparison'
        on_release: root.parent.parent.OpenHtmlComparison()         
		disabled: True
    




<File1ChoosePopup>:
    title: "Choose Configuration File 2"
    size_hint: .9, .9
    auto_dismiss: False
    BoxLayout:
        orientation: "vertical"

        BoxLayout:
            padding: 5
            spacing: 20
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}   
            ToggleButton:
                text: 'Icon View'
                state: 'down'
                group: 'filechooser'
                on_release: FileChooser.view_mode = 'icon'
            ToggleButton:
                text: 'List View'
                group: 'filechooser'
                on_release: FileChooser.view_mode = 'list' 
                
        FileChooser:
            id: FileChooser
            path: app.selected_storage_directory + '/Outputs/SaveConfOutput/'

            FileChooserIconLayout
            FileChooserListLayout

        BoxLayout:
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}
            spacing: 20
            Button:
                text: "Cancel"
                on_release: root.dismiss()
            Button:
                text: "Load"
                on_release: root.load(FileChooser.selection)
                id: ldbtn
                disabled: True if FileChooser.selection==[] else False


<File2ChoosePopup>:
    title: "Choose Configuration File 2"
    size_hint: .9, .9
    auto_dismiss: False
    BoxLayout:
        orientation: "vertical"

        BoxLayout:
            padding: 5
            spacing: 20
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}   
            ToggleButton:
                text: 'Icon View'
                state: 'down'
                group: 'filechooser'
                on_release: FileChooser.view_mode = 'icon'
            ToggleButton:
                text: 'List View'
                group: 'filechooser'
                on_release: FileChooser.view_mode = 'list' 
                
        FileChooser:
            id: FileChooser
            path: app.selected_storage_directory + '/Outputs/SaveConfOutput/'

            FileChooserIconLayout
            FileChooserListLayout

        BoxLayout:
            size_hint: (1, 0.1)
            pos_hint: {'center_x': .5, 'center_y': .5}
            spacing: 20
            Button:
                text: "Cancel"
                on_release: root.dismiss()
            Button:
                text: "Load"
                on_release: root.load(FileChooser.selection)
                id: ldbtn
                disabled: True if FileChooser.selection==[] else False